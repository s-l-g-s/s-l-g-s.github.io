var numberOfParticles=800,sitemap,lightParticles=[],poleLights=[],flowerBedLights=[],dmxAddressBook=[],gr,windField,oscilMonitor,lastAngleUpdatedTimer,poleLightJSON;function preload(){sitemap=loadImage("./data/images/sitemap.png"),poleLightJSON=loadJSON("./data/json/pole.json"),flowerBedsJSON=loadJSON("./data/json/flowerPot.json"),dmxAddressJSON=loadJSON("./data/json/dmxAddresses.json")}function setup(){var a=createCanvas(1920,840);a.parent("p5Container"),windField=new WindField(50),oscilMonitor=new OscilMonitor,oscilMonitor.setup(),windField.setAngle(random(180,360)),lastAngleUpdatedTimer=millis(),oscilMonitor.setFreq(random(20,300)),oscilMonitor.setParamA(random(2,4)),oscilMonitor.setParamB(random(1,5));for(var c,b=0;b<poleLightJSON.poles.length;b++)c=createVector(poleLightJSON.poles[b].x,poleLightJSON.poles[b].y),poleLights.push(new Light(poleLightJSON.poles[b].ID,c,1,1,255)),poleLights[b].setColor(74,205,240,100);for(var c,b=0;b<flowerBedsJSON.flowerBeds.length;b++)c=createVector(flowerBedsJSON.flowerBeds[b].x,flowerBedsJSON.flowerBeds[b].y),flowerBedLights.push(new Light(flowerBedsJSON.flowerBeds[b].ID,c,2,1,100)),flowerBedLights[b].setColor(71,200,242,100);for(var d,b=0;b<dmxAddressJSON.root.flowerPot.length;b++){d=[];for(var e=0;e<dmxAddressJSON.root.flowerPot[b].addr.length;e++)d.push(dmxAddressJSON.root.flowerPot[b].addr[e]);dmxAddressBook.push(d)}for(var c,b=0;b<numberOfParticles;b++)c=createVector(random(width),random(height)),lightParticles.push(new LightParticle(c,random(0.3,0.7),random(0.3,0.5)));gr=createVector(0,2)}function draw(){image(sitemap,0,0),windField.update(),oscilMonitor.updateBuffer(),millis()-lastAngleUpdatedTimer>30000&&(windField.setAngle(random(180,270)),this.oscilMonitor.setFreq(random(20,100)),lastAngleUpdatedTimer=millis());for(var a=0;a<poleLights.length;a++){for(var b=0;b<lightParticles.length;b++)10>dist(poleLights[a].pos.x,poleLights[a].pos.y,lightParticles[b].pos.x,lightParticles[b].pos.y)&&(poleLights[a].isOn=!0);poleLights[a].update(!1),poleLights[a].draw()}for(var a=0;a<flowerBedLights.length;a++)flowerBedLights[a].draw();for(var a=0;a<this.dmxAddressBook.length;a++)for(var b=0;b<this.dmxAddressBook[a].length;b++)for(var c=0;c<this.flowerBedLights.length;c++)this.dmxAddressBook[a][b]==this.flowerBedLights[c].ID&&this.flowerBedLights[c].setAlpha(map(this.oscilMonitor.getFlowerBedValue(int(map(c,0,this.flowerBedLights.length,1,width))),0,1,0,140));for(var a=0;a<lightParticles.length;a++)lightParticles[a].follow(windField),lightParticles[a].run(!1),lightParticles[a].draw(!1)}var numberOfParticles=800,sitemap,lightParticles=[],poleLights=[],flowerBedLights=[],dmxAddressBook=[],gr,windField,oscilMonitor,lastAngleUpdatedTimer,poleLightJSON;function preload(){sitemap=loadImage("./data/images/sitemap.png"),poleLightJSON=loadJSON("./data/json/pole.json"),flowerBedsJSON=loadJSON("./data/json/flowerPot.json"),dmxAddressJSON=loadJSON("./data/json/dmxAddresses.json")}function setup(){var a=createCanvas(1920,840);a.parent("p5Container"),windField=new WindField(35),oscilMonitor=new OscilMonitor,oscilMonitor.setup(),windField.setAngle(random(180,360)),lastAngleUpdatedTimer=millis(),oscilMonitor.setFreq(random(20,300)),oscilMonitor.setParamA(random(2,4)),oscilMonitor.setParamB(random(1,5));for(var c,b=0;b<poleLightJSON.poles.length;b++)c=createVector(poleLightJSON.poles[b].x,poleLightJSON.poles[b].y),poleLights.push(new Light(poleLightJSON.poles[b].ID,c,1,1,255)),poleLights[b].setColor(74,205,240,100);for(var c,b=0;b<flowerBedsJSON.flowerBeds.length;b++)c=createVector(flowerBedsJSON.flowerBeds[b].x,flowerBedsJSON.flowerBeds[b].y),flowerBedLights.push(new Light(flowerBedsJSON.flowerBeds[b].ID,c,2,1,100)),flowerBedLights[b].setColor(71,200,242,100);for(var d,b=0;b<dmxAddressJSON.root.flowerPot.length;b++){d=[];for(var e=0;e<dmxAddressJSON.root.flowerPot[b].addr.length;e++)d.push(dmxAddressJSON.root.flowerPot[b].addr[e]);dmxAddressBook.push(d)}for(var c,b=0;b<numberOfParticles;b++)c=createVector(random(width),random(height)),lightParticles.push(new LightParticle(c,random(0.3,0.7),random(0.3,0.5)));gr=createVector(0,2)}function draw(){image(sitemap,0,0),windField.update(),oscilMonitor.updateBuffer(),millis()-lastAngleUpdatedTimer>90000&&(windField.setAngle(random(180,270)),this.oscilMonitor.setFreq(random(20,100)),lastAngleUpdatedTimer=millis());for(var a=0;a<poleLights.length;a++){for(var b=0;b<lightParticles.length;b++)10>dist(poleLights[a].pos.x,poleLights[a].pos.y,lightParticles[b].pos.x,lightParticles[b].pos.y)&&(poleLights[a].isOn=!0);poleLights[a].update(!1),poleLights[a].draw()}for(var a=0;a<flowerBedLights.length;a++)flowerBedLights[a].draw();for(var a=0;a<this.dmxAddressBook.length;a++)for(var b=0;b<this.dmxAddressBook[a].length;b++)for(var c=0;c<this.flowerBedLights.length;c++)this.dmxAddressBook[a][b]==this.flowerBedLights[c].ID&&this.flowerBedLights[c].setAlpha(map(this.oscilMonitor.getFlowerBedValue(int(map(c,0,this.flowerBedLights.length,1,width))),0,1,0,140));for(var a=0;a<lightParticles.length;a++)lightParticles[a].follow(windField),lightParticles[a].run(!1),lightParticles[a].draw(!1)}